{include file="inc_map.txt"}

{if !$corrections|@count}

<p class="error">These are not the opinions you are looking for.</p>
<script type="text/javascript">
{literal}
$(document).ready(function(){
	$("#map").hide();
});
{/literal}
</script>
{else}

<table id="correction-details" class="table table-condensed table-bordered">
{include file="inc_correction_details_header.txt" correction_row=$corrections.0}

{foreach from=$corrections item="correction"}
{include file="inc_correction_details_row.txt" correction_row=$correction}
{/foreach}

</table>

{include file="inc_pagination.txt"}

<script type="text/javascript">
$(document).ready(function(){literal}{{/literal}
	var latlons = [{foreach from=$corrections item="row"}
		[{$row.latitude|escape},{$row.longitude|escape},{literal}{{/literal}'id':{$row.id|escape},'permalink':'{$row|@urls_correction_url}'{literal}}{/literal}],
	{/foreach}];

	var geojson = youarehere_map_latlons_to_geojson(latlons);
	youarehere_map_init(geojson);

	var woeids = [{foreach from=$corrections item="row" name="woeids"}{$row.woe_id|escape}{if !$smarty.foreach.woeids.last},{/if}{/foreach}];
	youarehere_woe_draw_shapes(woeids);

{literal}}{/literal});

{/if}

</script>
