function youarehere_locate(){var a=function(b){var c=$("#status");c.html("<li>"+b+"</li>"+c.html())};navigator.geolocation.getCurrentPosition(function(b){b=b.coords;var c=b.latitude,e=b.longitude;a("The sensors have placed you at or around "+c+","+e+".");a("Now to figure out where that is.");setTimeout(function(){location.href=location.href+"?lat="+c+"&lon="+e},2500)},function(){});a("Asking the sky where you are.")};function youarehere_correction_draw_map(a){$.ajax({url:a,success:function(b){youarehere_map_init(b);youarehere_woe_draw_shapes([b.features[0].properties.woe_id])}})};var _map=null;function youarehere_map(){if(!_map){$("#".container_id).show();var a=L.map("map",{zoomControl:false,attributionControl:false});L.tileLayer("http://tile.stamen.com/toner-background/{z}/{x}/{y}.jpg",{attribution:"",maxZoom:18,minZoom:12}).addTo(a);_map=a}return _map}function youarehere_map_init(a){youarehere_map();youarehere_map_set_viewport(a);youarehere_map_draw_features(a)}
function youarehere_map_set_viewport(a){var b=youarehere_map();a=a.features[0];var c=a.bbox;if(c)b.fitBounds([[c[1],c[0]],[c[3],c[2]]]);else{a=a.geometry.coordinates;b.setView([a[1],a[0]],15)}}
function youarehere_map_draw_features(a){var b=null,c=youarehere_map(),e={color:"#000",weight:2,opacity:1,fillOpacity:0.8,fillColor:"#afceee"},h={color:"red",weight:4,opacity:1,fillOpacity:1,fillColor:"white",radius:8},g=function(d){d=d.target;d.setStyle({color:"red",fillColor:"#8ca4be"});!L.Browser.ie&&!L.Browser.opera&&d.bringToFront()},f=function(d){b.resetStyle(d.target)};b=L.geoJson(a,{style:function(d){if(d.geometry.type!="Point")return e},pointToLayer:function(d,i){return L.circleMarker(i,
h)},onEachFeature:function(d,i){i.on({mouseover:g,mouseout:f})}});b.addTo(c);return b}function youarehere_map_latlons_to_geojson(a){for(var b=[],c=a.length,e=0;e<c;e++)b.push({type:"Feature",geometry:{type:"Point",coordinates:[a[e][1],a[e][0]]}});b={type:"FeatureCollection",features:b};if(c>1){a=youarehere_map_coords_to_bbox(a);b.bbox=a}return b}
function youarehere_map_coords_to_bbox(a,b){for(var c=a.length,e=undefined,h=undefined,g=undefined,f=undefined,d=0;d<c;d++){var i=b?a[d][1]:a[d][0],j=b?a[d][0]:a[d][0];e=e==undefined?i:Math.min(e,i);h=h==undefined?j:Math.min(h,j);g=g==undefined?i:Math.max(g,i);f=f==undefined?j:Math.max(f,j)}c=[h,e,f,g];for(d in c)c[d]=c[d].toFixed(3);return c};function youarehere_woe_draw_shapes(a){for(var b=a.length,c=0;c<b;c++){var e=a[c],h="http://woe.spum.org/id/"+e+"/shape.js";if(e==18807771)h="http://gowanusheights.info/data/gowanus-heights.json";$.ajax({url:h,dataType:"json",success:function(g){var f=undefined;if(g.type=="FeatureCollection")f=g;else{if(!g.bbox){f=g.geometry.coordinates;f=f[0][0];f=youarehere_map_coords_to_bbox(f,"lonlat");g.bbox=f}f={type:"FeatureCollection",features:[g]}}try{youarehere_map_draw_features(f).bringToBack();youarehere_map_set_viewport(f)}catch(d){}},
error:function(){}})}};
